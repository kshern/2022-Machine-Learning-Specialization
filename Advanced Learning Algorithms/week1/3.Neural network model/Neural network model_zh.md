# Neural network model

## Neural network layer


大多数现代神经网络的基本构建模块是神经元层。在本视频中，您将学习如何构建神经元层，一旦您掌握了这一点，您就能够将这些构建模块组合在一起形成一个大型的神经网络。让我们来看看神经元层的工作原理。我们以需求预测示例中的例子为例，其中有四个输入特征被设置为该隐藏层中的三个神经元，然后将其输出发送到仅有一个神经元的输出层。让我们放大看隐藏层的计算过程。隐藏层输入四个数字，这四个数字是每个神经元的输入。每个神经元只是实现了一个小型的逻辑回归单元或逻辑回归函数。以第一个神经元为例，它有两个参数w和b。实际上，为了表示这是第一个隐藏单元，我会在下标上加上w₁、b₁。它的输出是某个激活值a，即g(w₁·x + b₁)，其中g(z)是您在先前课程中学到的逻辑函数，即1 / (1 + e^(-z))。也许最终得到的是一个数字0.3，这就是第一个神经元的激活值a₁。为了表示这是第一个神经元，我还会在这里加上一个下标a₁，所以a₁可能是一个像0.3这样的数值，表示根据输入特征，有0.3的可能性它具有很高的可负担性。现在让我们来看看第二个神经元。第二个神经元有参数w₂和b₂，这些w和b或w₂、b₂是第二个逻辑单元的参数。它计算a₂ = g(w₂·x + b₂)，这可能是另一个数字，比如0.7。在这个例子中，我们认为有0.7的可能性潜在买家会注意到这件T恤。类似地，第三个神经元有一组参数w₃、b₃。同样，它计算一个激活值a₃ = g(w₃·x + b₃)，可能是0.2。在这个例子中，这三个神经元的输出是0.3、0.7和0.2，这个由三个数字组成的向量成为激活值向量a，然后传递到神经网络的最终输出层。当您构建具有多个层的神经网络时，给各个层编号是很有用的。按照惯例，这一层被称为神经网络的第1层，这一层被称为神经网络的第2层。输入层有时也被称为第0层，现在有的神经网络甚至可以有几十甚至几百个层。为了引入符号以帮助我们区分不同的层，我将使用上标方括号1来索引不同的层。特别地，上标方括号1表示这个神经网络隐藏层的第1层的输出，类似地，w₁、b₁是神经网络第1层中第一个单元的参数，所以我也在这里加上了上标方括号1，w₂、b₂是第1层中第二个隐藏单元的参数，也用w^[1]表示。同样地，我可以添加上标方括号来表示这些是神经网络第1层隐藏单元的激活值。我知道这个符号可能有些凌乱，但需要记住的是，当您看到上标方括号1时，它只是指与神经网络的第1层相关的量。如果您看到上标方括号2，它指的是与神经网络的第2层相关的量，其他层也是类似的，包括第3层、第4层等等，适用于具有更多层的神经网络。这是这个神经网络第1层的计算过程。它的输出是激活向量a^[1]，我将它复制到这里，因为这个输出a₁成为第2层的输入。现在让我们放大看神经网络的第2层计算过程，即输出层。第2层的输入是第1层的输出，所以a₁就是我们刚刚在幻灯片的前面部分计算得到的向量0.3、0.7、0.2。因为输出层只有一个神经元，它只计算a₁，即g(w₁·a^[1] + b₁)，这是该层的输入，然后加上b₁。这里，z和g与之前相同，如果结果是一个数字，比如0.84，那就成为神经网络的输出层。在这个例子中，因为输出层只有一个神经元，所以输出只是一个标量，一个单独的数字，而不是一组数字。为了保持符号的一致性，我们将使用上标方括号2来表示与神经网络第2层相关的量，所以a^[2]就是这一层的输出，我也将它复制到这里作为神经网络的最终输出。为了使符号一致，您还可以添加上标方括号2来表示这些是与神经网络第2层相关的参数和激活值。一旦神经网络计算出a₂，还有一个最后的可选步骤，您可以选择实施或不实施，即如果您希望进行二元预测，即1或0，即这是一个畅销品还是不是？您可以取数值a上标方括号2下标1，即我们计算出的0.84，然后将其阈值设为0.5。如果大于0.5，您可以预测y hat等于1，如果小于0.5，则预测y hat等于0。当您在专业课程的第一门课中学习逻辑回归时，也看到了这种阈值处理。如果您希望，这样可以给出二元预测y hat，要么是1，要么是0，而不仅仅是它是畅销品的概率。这就是神经网络的工作原理。每一层接收一个数字向量并对其应用一系列逻辑回归单元，然后计算出另一个数字向量，然后从一层传递到另一层，直到到达神经网络的最终输出层的计算，这就是神经网络的预测结果。然后，您可以选择在0.5处进行阈值处理或不进行阈值处理，以得出最终的预测结果。通过我们已经建立的基础，我们现在可以看一些更复杂、更大的神经网络模型。希望通过看更多的例子，层的概念以及如何将它们组合在一起构建神经网络会变得更加清晰。所以让我们继续下一个视频。